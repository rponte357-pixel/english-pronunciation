<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Pronunciaci√≥n -ed | Explorador + Misi√≥n</title>
  <style>
    /* =========================
       APP SHELL (nuevo)
       ========================= */
    :root{
      --app-bg: #0f1115;
      --app-card: rgba(255,255,255,0.06);
      --app-text: #ffffff;
      --app-muted: rgba(255,255,255,0.65);
      --app-accent: #ffa502;
      --app-border: rgba(255,255,255,0.12);
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body{
      scroll-behavior: smooth;

      margin:0;
      background: var(--app-bg);
      color: var(--app-text);
      font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      min-height:100vh;
    }

    .app-topbar{
      position: sticky;
      top:0;
      z-index: 2500;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content: space-between;
      padding: 14px 16px;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--app-border);
    }

    .app-title{
      display:flex;
      flex-direction: column;
      gap:2px;
      line-height: 1.1;
    }
    .app-title strong{ font-size: 1.05rem; }
    .app-title span{ font-size: 0.82rem; color: var(--app-muted); }

    .app-tabs{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    .app-tab{
      border: 1px solid var(--app-border);
      background: transparent;
      color: var(--app-text);
      padding: 10px 12px;
      border-radius: 12px;
      cursor:pointer;
      font-weight: 700;
      font-size: 0.95rem;
      transition: transform .15s, background .15s, border-color .15s;
      white-space: nowrap;
    }
    .app-tab:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.06); }
    .app-tab.active{
      border-color: rgba(255,165,2,0.65);
      background: rgba(255,165,2,0.16);
      color: #fff;
    }

    .app-view{ display:none; }
    .app-view.active{ display:block; }

    /* =========================
       VIEW: EXPLORADOR (tu 1¬™ p√°gina)
       NAMESPACE: .explorer
       ========================= */
    .explorer{
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #333;
      padding: 20px;
      min-height: calc(100vh - 62px); /* topbar */
    }
    .explorer * { margin: 0; padding: 0; }

    .explorer .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    .explorer .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 40px;
      text-align: center;
    }

    .explorer .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }

    .explorer .header p {
      font-size: 1.2em;
      opacity: 0.9;
    }

    .explorer .youtube-link {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 15px 30px;
      background: #ff0000;
      color: white;
      text-decoration: none;
      border-radius: 10px;
      font-weight: 700;
      font-size: 1.2em;
      transition: all 0.3s;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
      border: 3px solid white;
    }

    .explorer .youtube-link:hover {
      background: #cc0000;
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
    }

    .explorer .stats-bar {
      display: flex;
      justify-content: space-around;
      padding: 20px;
      background: #f8f9fa;
      border-bottom: 2px solid #e9ecef;
      flex-wrap: wrap;
      gap: 10px;
    }

    .explorer .stat-item {
      text-align: center;
      padding: 15px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      min-width: 150px;
      flex: 1;
    }

    .explorer .stat-number {
      font-size: 2em;
      font-weight: bold;
      color: #667eea;
    }

    .explorer .stat-label {
      font-size: 0.9em;
      color: #6c757d;
      margin-top: 5px;
    }

    .explorer .controls {
      padding: 30px 40px;
      background: white;
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      align-items: center;
      border-bottom: 2px solid #e9ecef;
    }

    .explorer .search-box {
      flex: 1;
      min-width: 250px;
    }

    .explorer .search-box input {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      font-size: 1em;
      transition: all 0.3s;
    }

    .explorer .search-box input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .explorer .filter-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .explorer .filter-btn {
      padding: 12px 24px;
      border: 2px solid #e9ecef;
      background: white;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.3s;
    }

    .explorer .filter-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .explorer .filter-btn.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .explorer .mode-toggle {
      padding: 12px 24px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      transition: all 0.3s;
    }

    .explorer .mode-toggle:hover {
      background: #218838;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .explorer .rules-section {
      padding: 40px;
      background: #f8f9fa;
    }

    .explorer .rules-section h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.8em;
    }

    .explorer .summary-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .explorer .summary-table th, .explorer .summary-table td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid #e9ecef;
    }

    .explorer .summary-table th {
      background: #667eea;
      color: white;
      font-weight: 600;
    }

    .explorer .summary-table tr:hover { background: #f8f9fa; }

    .explorer .verb-lists-section { padding: 40px; }

    /* ===== ACORDE√ìN PARA LISTAS DE VERBOS ===== */
    .explorer .verb-list {
      background: white;
      border-radius: 15px;
      margin-bottom: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: all 0.3s;
    }

    .explorer .verb-list-header {
      padding: 20px 25px;
      cursor: pointer;
      user-select: none;
      position: relative;
      transition: background 0.2s;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .explorer .verb-list-header:hover {
      background: #f8f9fa;
    }

    .explorer .verb-list-header h3 {
      margin: 0;
      font-size: 1.5em;
      font-weight: 700;
    }

    /* Flecha del acorde√≥n de verbos */
    .explorer .verb-list-header::after {
      content: '‚ñ∂';
      font-size: 1.5em;
      font-weight: bold;
      color: #6b7bf5;
      transition: transform 0.3s ease;
    }

    .explorer .verb-list.expanded .verb-list-header::after {
      transform: rotate(90deg);
    }

    /* Contenido colapsable */
    .explorer .verb-list-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease-out, padding 0.4s ease-out;
      padding: 0 25px;
    }

    .explorer .verb-list.expanded .verb-list-content {
      max-height: 10000px;
      padding: 0 25px 25px 25px;
    }

    /* Colores espec√≠ficos para cada categor√≠a */
    .explorer .verb-list.id-list .verb-list-header h3 { color: #dc3545; }
    .explorer .verb-list.t-list .verb-list-header h3 { color: #ffc107; }
    .explorer .verb-list.d-list .verb-list-header h3 { color: #28a745; }


    .explorer .verb-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 10px;
    }

    .explorer .verb-item {
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
      border: 2px solid transparent;
      position: relative;
      user-select: none;
    }

    .explorer .verb-item .example-text {
      visibility: hidden;
      width: 220px;
      background-color: #333;
      color: white;
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1001;
      bottom: 100%;
      left: 50%;
      margin-left: -110px;
      opacity: 0;
      transition: opacity 0.3s, visibility 0.3s;
      font-size: 0.9em;
      line-height: 1.4;
      white-space: normal;
    }

    .explorer .verb-item:hover .example-text { visibility: visible; opacity: 1; }

    .explorer .verb-item .example-text::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #333 transparent transparent transparent;
    }

    .explorer .verb-item:hover {
      background: #667eea;
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .explorer .verb-item.played {
      background: #e7f5ff;
      border-color: #667eea;
    }

    .explorer .verb-item.played::after {
      content: '‚úì';
      position: absolute;
      top: -5px;
      right: -5px;
      background: #28a745;
      color: white;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .explorer .verb-item:active { transform: scale(0.95); }

    .explorer .practice-mode { display: none; padding: 40px; background: #f8f9fa; }
    .explorer .practice-mode.active { display: block; }

    .explorer .quiz-container {
      max-width: 700px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .explorer .quiz-question {
      font-size: 1.5em;
      margin-bottom: 30px;
      text-align: center;
      color: #333;
    }

    .explorer .quiz-verb {
      font-size: 2.5em;
      font-weight: bold;
      color: #667eea;
      margin: 30px 0;
      text-align: center;
    }

    .explorer .quiz-options {
      display: grid;
      gap: 15px;
      margin-top: 30px;
    }

    .explorer .quiz-option {
      padding: 20px;
      background: #f8f9fa;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 1.1em;
      text-align: center;
      user-select: none;
    }

    .explorer .quiz-option:hover {
      background: #e9ecef;
      transform: translateX(5px);
    }

    .explorer .quiz-option.correct { background: #d4edda; border-color: #28a745; animation: explorer-pulse 0.5s; }
    .explorer .quiz-option.incorrect { background: #f8d7da; border-color: #dc3545; animation: explorer-shake 0.5s; }

    .explorer .quiz-score {
      text-align: center;
      margin-top: 30px;
      font-size: 1.3em;
      color: #667eea;
      font-weight: 600;
    }

    @keyframes explorer-pulse { 0%,100%{ transform:scale(1);} 50%{ transform:scale(1.05);} }
    @keyframes explorer-shake { 0%,100%{ transform:translateX(0);} 25%{ transform:translateX(-10px);} 75%{ transform:translateX(10px);} }

    .explorer .drag-option{
      padding: 15px 25px;
      background: #764ba2;
      color: white;
      border-radius: 8px;
      cursor: grab;
      font-size: 1.2em;
      font-weight: bold;
      transition: transform 0.2s, opacity 0.2s;
      user-select: none;
    }
    .explorer .drag-option:hover{
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .explorer #explorer-dropZone.correct{
      background-color: #d4edda;
      border-color: #28a745;
      color: #28a745;
    }
    .explorer #explorer-dropZone.incorrect{
      background-color: #f8d7da;
      border-color: #dc3545;
      color: #dc3545;
      animation: explorer-shake 0.5s;
    }

    .explorer .hidden { display:none !important; }

    .explorer .audio-player-float{
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
      z-index: 2200; /* por encima del contenido; por debajo del feedback del juego */
      display: none;
      min-width: 300px;
    }
    .explorer .audio-player-float.show{ display:block; animation: explorer-slideUp .3s; }
    .explorer .audio-player-title{
      font-size: 1.2em;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 10px;
    }
    @keyframes explorer-slideUp{ from{ transform: translateY(100px); opacity:0;} to{ transform: translateY(0); opacity:1;} }

    @media (max-width: 768px) {
      .explorer .header h1 { font-size: 1.8em; }
      .explorer .stats-bar { flex-direction: column; }
      .explorer .controls { flex-direction: column; }
      .explorer .verb-list-container { grid-template-columns: 1fr; }
      .explorer .audio-player-float{ left: 10px; right: 10px; min-width: unset; }
    }

    /* =========================
       VIEW: MISI√ìN (tu 2¬™ p√°gina)
       NAMESPACE: .mission
       ========================= */
    .mission{
      min-height: calc(100vh - 62px);
      background-color: #1e2124;
      color: #ffffff;
    }
    .mission :root{}
    .mission .content{
      flex: 1;
      padding: 20px;
      padding-bottom: 90px;
      overflow-y: auto;
      max-width: 1000px;
      margin: 0 auto;
    }
    .mission .hidden{ display:none !important; }

    .mission .rule-card{
      background: #2f3136;
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      border-left: 5px solid white;
    }
    .mission .rule-card.id { border-color: #ff4757; }
    .mission .rule-card.t { border-color: #ffa502; }
    .mission .rule-card.d { border-color: #2ed573; }
    .mission .rule-card h2{ margin-top: 0; font-size: 1.4em; }
    .mission .rule-card h3{ color:#bbb; font-size: 1em; }

    .mission .game-header{ text-align:center; margin-bottom: 30px; }
    .mission .verb-display{
      background: #2f3136;
      height: 200px;
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius: 20px;
      font-size: 3em;
      font-weight: bold;
      margin-bottom: 30px;
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
      border: 2px solid #444;
    }

    .mission .btn-grid{ display:grid; grid-template-columns: 1fr; gap: 15px; }
    .mission .choice-btn{
      padding: 20px;
      border:none;
      border-radius: 12px;
      color:white;
      font-size: 1.2em;
      font-weight:bold;
      display:flex;
      justify-content: space-between;
      align-items:center;
      cursor:pointer;
      user-select:none;
    }
    .mission .btn-id{ background:#ff4757; }
    .mission .btn-t{ background:#ffa502; }
    .mission .btn-d{ background:#2ed573; }

    .mission .feedback{
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 8em;
      opacity: 0;
      pointer-events: none;
      z-index: 2600;
    }
    @keyframes mission-pop{
      0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
      50% { opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1.2); opacity: 0; }
    }
    .mission .animate-pop{ animation: mission-pop 0.5s ease-out; }

    .mission .stats-bar{
      display:flex;
      justify-content: space-around;
      margin-bottom: 20px;
      background: rgba(255,255,255,0.05);
      padding: 10px;
      border-radius: 10px;
    }

    /* Navegaci√≥n inferior SOLO para Misi√≥n */
    .mission .nav{
      position: fixed;
      bottom: 0;
      width: 100%;
      display:flex;
      background: #000;
      padding: 10px 0;
      z-index: 2400;
      border-top: 1px solid rgba(255,255,255,0.08);
    }
    .mission .nav-item{
      flex:1;
      text-align:center;
      color:#8e9297;
      font-size: 0.8em;
      cursor:pointer;
      user-select:none;
    }
    .mission .nav-item.active{ color:#ffa502; }
  
    /* ===== ACORDE√ìN DE REGLAS: SIEMPRE COLAPSADO POR DEFECTO ===== */
    .explorer .rule-accordion { 
      display: none !important; 
    }
    .explorer .rule-accordion.open { 
      display: table-row !important; 
    }
    
    .explorer .rule-row {
      cursor: pointer;
      transition: transform .15s, background .15s;
      position: relative;
      user-select: none;
    }
    .explorer .rule-row td {
      padding-right: 50px !important;
    }
    .explorer .rule-row:hover {
      background: #e8eeff !important;
      transform: translateX(2px);
    }
    .explorer .rule-row:focus {
      outline: 3px solid rgba(102,126,234,0.35);
      outline-offset: 2px;
    }

    /* Flecha triangular grande y visible */
    .explorer .rule-row::after {
      content: '‚ñ∂';
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.8em;
      font-weight: bold;
      color: #6b7bf5;
      transition: transform 0.3s ease;
    }
    .explorer .rule-row[aria-expanded="true"]::after {
      transform: translateY(-50%) rotate(90deg);
      color: #5563e8;
    }

    .explorer .rule-accordion-inner{
      background: #f0f2f7;
      border: 2px solid #e0e4f0;
      border-radius: 12px;
      padding: 20px 24px;
      margin: 8px 0;
      animation: slideDown 0.3s ease;
    }
    
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .explorer .rule-accordion-inner h4{
      margin: 0 0 12px 0;
      color: #667eea;
      font-size: 1.2em;
    }
    .explorer .rule-accordion-inner p{
      margin: 8px 0;
      line-height: 1.6;
      color: #2c3e50;
    }
    .explorer .rule-accordion-inner ul{
      margin: 10px 0 10px 20px;
      padding: 0;
    }
    .explorer .rule-accordion-inner li{
      margin: 6px 0;
      line-height: 1.5;
      color: #2c3e50;
    }
    .explorer .rule-accordion-inner code{
      background: #e8ecf7;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      color: #d63384;
      font-size: 0.95em;
    }
    .explorer .rule-accordion-inner b, .explorer .rule-accordion-inner strong{
      color: #1a1a1a;
    }
    .explorer .sound-chip{
      display: inline-block;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(102,126,234,0.12);
      border: 1px solid rgba(102,126,234,0.25);
      font-weight: 800;
      letter-spacing: 0.5px;
    }
    .explorer .rule-jump{
      margin-top: 10px;
    }

  
    /* Adjetivos: reutilizan el mismo estilo que los verbos */
    #explorer-adjSection .verb-item{
      cursor: default;
    }

    /* =========================
       VIEW: ERRORES
       ========================= */
    .errors {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: #333;
      padding: 20px;
      min-height: calc(100vh - 62px);
    }

    .errors .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    .errors .header {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 40px;
      text-align: center;
    }

    .errors .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }

    .errors .stats-bar {
      display: flex;
      justify-content: space-around;
      padding: 20px;
      background: #f8f9fa;
      border-bottom: 2px solid #e9ecef;
      flex-wrap: wrap;
      gap: 10px;
    }

    .errors .stat-item {
      text-align: center;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
      min-width: 140px;
      flex: 1;
      transition: transform 0.3s;
    }

    .errors .stat-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    }

    .errors .stat-number {
      font-size: 2.5em;
      font-weight: bold;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
    }

    .errors .stat-label {
      font-size: 0.9em;
      color: #6c757d;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .errors .content {
      padding: 40px;
      background: white;
    }

    .errors-list {
      display: grid;
      gap: 20px;
    }

    .error-card {
      background: #fff;
      border-left: 6px solid #dc3545;
      border-radius: 12px;
      padding: 20px 25px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: all 0.3s;
      position: relative;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .error-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }

    .error-card.id-error { border-left-color: #dc3545; }
    .error-card.t-error { border-left-color: #ffc107; }
    .error-card.d-error { border-left-color: #28a745; }

    .error-card-word {
      font-size: 1.5em;
      font-weight: 700;
      color: #2c3e50;
    }

    .error-card-answer {
      font-size: 1.1em;
      font-weight: 600;
      color: #667eea;
    }

    /* ===== RESPONSIVE M√ìVIL ===== */
    @media (max-width: 600px) {
      .app-topbar {
        flex-direction: column;
        padding: 12px;
        gap: 10px;
      }
      .app-title {
        text-align: center;
      }
      .app-tabs {
        width: 100%;
        justify-content: center;
      }
      .app-tab {
        flex: 1;
        font-size: 0.85rem;
        padding: 10px 8px;
      }
      
      .explorer {
        padding: 10px;
      }
      .explorer .header {
        padding: 20px 15px;
      }
      .explorer .header h1 {
        font-size: 1.6em;
      }
      .explorer .youtube-link {
        font-size: 1em;
        padding: 12px 20px;
      }
      .explorer .stats-bar {
        padding: 12px;
        gap: 8px;
      }
      .explorer .stat-item {
        min-width: 80px;
        padding: 10px;
      }
      .explorer .controls {
        padding: 15px;
      }
      .explorer .search-box {
        min-width: 100%;
      }
      .explorer .filter-buttons {
        width: 100%;
        gap: 8px;
      }
      .explorer .filter-btn {
        flex: 1;
        padding: 10px 8px;
        font-size: 0.85em;
      }
      .explorer .mode-toggle {
        width: 100%;
        padding: 12px;
      }
      .explorer .content {
        padding: 15px;
      }
      .explorer .verb-grid {
        grid-template-columns: 1fr;
        gap: 10px;
      }
      .explorer .rules-section {
        padding: 15px;
      }
      .explorer .summary-table {
        font-size: 0.8em;
      }
      .explorer .summary-table th,
      .explorer .summary-table td {
        padding: 8px 6px;
      }
      .explorer .rule-row td {
        padding-right: 45px !important;
      }
      .explorer .rule-row::after {
        right: 10px;
        font-size: 1.3em;
      }
      
      /* Acordeones de verbos en m√≥vil */
      .explorer .verb-list-header {
        padding: 15px 18px;
      }
      .explorer .verb-list-header h3 {
        font-size: 1.2em;
      }
      .explorer .verb-list-header::after {
        font-size: 1.2em;
      }
      .explorer .verb-list.expanded .verb-list-content {
        padding: 0 18px 18px 18px;
      }
      .explorer .verb-lists-section {
        padding: 20px 15px;
      }
      
      .mission {
        padding: 10px;
      }
      .mission .game-header {
        padding: 20px 15px;
      }
      .mission .game-area {
        padding: 20px 15px;
      }
      .mission .question-screen .word-display {
        font-size: 2em;
        padding: 20px 15px;
      }
      .mission .answer-btn {
        padding: 15px 20px;
        font-size: 1em;
      }
      
      /* Errores en m√≥vil */
      .errors {
        padding: 10px;
      }
      .errors .header {
        padding: 25px 15px;
      }
      .errors .header h1 {
        font-size: 1.8em;
      }
      .errors .content {
        padding: 20px 15px;
      }
      .errors .stats-bar {
        padding: 15px 10px;
      }
      .errors .stat-item {
        min-width: 100px;
        padding: 15px 10px;
      }
      .errors .stat-number {
        font-size: 2em;
      }
      .errors .stat-label {
        font-size: 0.75em;
      }
      .error-card {
        padding: 15px 18px;
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      .error-card-word {
        font-size: 1.3em;
      }
      .error-card-answer {
        font-size: 1em;
      }
    }

  </style>
</head>
<body>

  <!-- APP TOPBAR -->
  <div class="app-topbar">
    <div class="app-title">
      <strong>Pronunciaci√≥n del -ed</strong>
      <span>Explorador (audio + quiz) ¬∑ Misi√≥n (juego m√≥vil)</span>
    </div>
    <div class="app-tabs">
      <button class="app-tab active" id="tab-explorer" onclick="appShow('explorer')">üß≠ Explorador</button>
      <button class="app-tab" id="tab-mission" onclick="appShow('mission')">üéÆ Misi√≥n</button>
      <button class="app-tab" id="tab-errors" onclick="appShow('errors')">‚ùå Mis Errores</button>
    </div>
  </div>

  <!-- =========================
       VIEW 1: EXPLORADOR
       ========================= -->
  <section class="app-view active explorer" id="view-explorer">
    <div class="container">
      <div class="header">
        <!-- Enlace al video de YouTube -->
        <div style="margin-bottom: 30px; padding: 10px;">
          <a href="https://youtu.be/vv7cBMCBUdk?si=1IEpIsDtzZgJk0lP" 
             target="_blank" 
             rel="noopener noreferrer"
             class="youtube-link">
            <span style="font-size: 1.5em;">‚ñ∂Ô∏è</span>
            <span>Ver Video Explicativo en YouTube</span>
          </a>
        </div>
        
        <h1>üéØ Pronunciaci√≥n del -ed en Ingl√©s</h1>
        <p>Pasa el rat√≥n sobre un verbo para ver el ejemplo y haz clic para escuchar</p>
      </div>

      <div class="stats-bar">
        <div class="stat-item">
          <div class="stat-number" id="explorer-totalVerbs">120</div>
          <div class="stat-label">Verbos Totales</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="explorer-practicedVerbs">0</div>
          <div class="stat-label">Escuchados</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="explorer-quizScore">0/0</div>
          <div class="stat-label">Quiz Score</div>
        </div>
      </div>

      <!-- ===== REGLAS PRIMERO ===== -->
      <div class="rules-section" id="explorer-rulesSection">
        <h2 style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
          <span style="font-size: 1.3em;">üìö</span> Reglas de Pronunciaci√≥n
        </h2>

        <p style="color:#6c85a8; margin: 0 0 20px 0; font-weight: 500; display: flex; align-items: center; gap: 8px;">
          <span style="font-size: 1.1em;">‚¨áÔ∏è</span> Haz clic en cualquier regla para ver su explicaci√≥n completa
        </p>

        <table class="summary-table">
          <thead>
            <tr>
              <th>Sonido</th>
              <th>Regla</th>
              <th>Ejemplo</th>
              <th>Caracter√≠stica</th>
            </tr>
          </thead>
          <tbody>
            <!-- /…™d/ -->
            <tr class="rule-row" data-target="acc-id" tabindex="0" role="button" aria-expanded="false">
              <td><strong>/…™d/</strong></td>
              <td>Termina en <strong>/t/</strong> o <strong>/d/</strong></td>
              <td>wait ‚Üí wait<strong>ed</strong></td>
              <td>üî¥ S√≠laba EXTRA</td>
            </tr>
            <tr class="rule-accordion" id="acc-id" aria-hidden="true">
              <td colspan="4">
                <div class="rule-accordion-inner">
                  <div class="rule-accordion-content" data-tpl="tpl-rule-id"></div>
                </div>
              </td>
            </tr>

            <!-- /t/ -->
            <tr class="rule-row" data-target="acc-t" tabindex="0" role="button" aria-expanded="false">
              <td><strong>/t/</strong></td>
              <td>Termina en sonido <strong>sordo</strong></td>
              <td>look ‚Üí look<strong>ed</strong></td>
              <td>üü° Sordo + Sordo</td>
            </tr>
            <tr class="rule-accordion" id="acc-t" aria-hidden="true">
              <td colspan="4">
                <div class="rule-accordion-inner">
                  <div class="rule-accordion-content" data-tpl="tpl-rule-t"></div>
                </div>
              </td>
            </tr>

            <!-- /d/ -->
            <tr class="rule-row" data-target="acc-d" tabindex="0" role="button" aria-expanded="false">
              <td><strong>/d/</strong></td>
              <td>Termina en sonido <strong>sonoro</strong> o vocal</td>
              <td>clean ‚Üí clean<strong>ed</strong></td>
              <td>üü¢ Sonoro + Sonoro</td>
            </tr>
            <tr class="rule-accordion" id="acc-d" aria-hidden="true">
              <td colspan="4">
                <div class="rule-accordion-inner">
                  <div class="rule-accordion-content" data-tpl="tpl-rule-d"></div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <!-- Templates de explicaci√≥n completa (NO visibles por defecto) -->
        <template id="tpl-rule-id">
          <h4>üî¥ /…™d/ ‚Üí s√≠laba extra</h4>
          <p><b>Regla:</b> Termina en sonido <b>/t/</b> o <b>/d/</b>, por eso se a√±ade una s√≠laba extra.</p>
          <p><b>Ejemplo:</b> <code>wanted</code> ¬∑ <b>IPA:</b> <code>/Ààw…ín.t…™d/</code> ¬∑ <b>Suena:</b> <span class="sound-chip">WON‚Äìtid</span></p>
          <p style="margin: 10px 0 6px 0;"><b>Sensaci√≥n auditiva:</b></p>
          <ul>
            <li>Dos golpes claros</li>
            <li>Se oye una vocal corta <code>/…™/</code> antes de la <b>d</b></li>
            <li>Parece casi una palabra nueva</li>
          </ul>
          <p><b>Audio ideal dir√≠a:</b> "wanted" ‚Üí <b>won-tid</b></p>
        </template>

        <template id="tpl-rule-t">
          <h4>üü° /t/ ‚Üí sonido sordo</h4>
          <p><b>Regla:</b> Termina en sonido <b>sordo</b> (p, k, f, s, sh, ch, x‚Ä¶), as√≠ que el -ed se pronuncia <b>/t/</b>.</p>
          <p><b>Ejemplo:</b> <code>worked</code> ¬∑ <b>IPA:</b> <code>/w…úÀêkt/</code> ¬∑ <b>Suena:</b> <span class="sound-chip">WORKT</span></p>
          <p style="margin: 10px 0 6px 0;"><b>Sensaci√≥n auditiva:</b></p>
          <ul>
            <li>No hay vocal extra</li>
            <li>Final seco, cortado</li>
            <li>La <b>t</b> se "pega" al verbo</li>
          </ul>
          <p><b>Audio ideal dir√≠a:</b> "worked" ‚Üí <b>workt</b></p>
        </template>

        <template id="tpl-rule-d">
          <h4>üü¢ /d/ ‚Üí sonido sonoro</h4>
          <p><b>Regla:</b> Termina en sonido <b>sonoro</b> (vocal, l, n, r, b, g, v, z, m‚Ä¶), as√≠ que el -ed se pronuncia <b>/d/</b>.</p>
          <p><b>Ejemplo:</b> <code>played</code> ¬∑ <b>IPA:</b> <code>/ple…™d/</code> ¬∑ <b>Suena:</b> <span class="sound-chip">PLEID</span></p>
          <p style="margin: 10px 0 6px 0;"><b>Sensaci√≥n auditiva:</b></p>
          <ul>
            <li>Una sola s√≠laba</li>
            <li>La <b>d</b> final es suave</li>
            <li>La voz sigue vibrando</li>
          </ul>
          <p><b>Audio ideal dir√≠a:</b> "played" ‚Üí <b>pleid</b></p>
        </template>
      </div>

      <!-- ===== AHORA S√ç LOS CONTROLES Y VERBOS ===== -->
      <div class="controls">
        <div class="search-box">
          <input type="text" id="explorer-searchInput" placeholder="üîç Buscar verbo...">
        </div>
        <div class="filter-buttons">
          <button class="filter-btn active" data-filter="all" data-scope="explorer">Todos</button>
          <button class="filter-btn" data-filter="id" data-scope="explorer">üî¥ /…™d/</button>
          <button class="filter-btn" data-filter="t" data-scope="explorer">üü° /t/</button>
          <button class="filter-btn" data-filter="d" data-scope="explorer">üü¢ /d/</button>
        </div>
        <button class="mode-toggle" onclick="explorerTogglePracticeMode()">üéÆ Modo Pr√°ctica</button>
      </div>

      
      
      <div class="rules-section" id="explorer-rulesSection">
        <h2>üìö Reglas de Pronunciaci√≥n</h2>

        <p style="color:#6c757d; margin: 0 0 18px 0; font-weight: 500;">
          ‚¨áÔ∏è Haz clic en cualquier regla para ver su explicaci√≥n completa
        </p>

        <table class="summary-table">
          <thead>
            <tr>
              <th>Sonido</th>
              <th>Regla</th>
              <th>Ejemplo</th>
              <th>Caracter√≠stica</th>
            </tr>
          </thead>
          <tbody>
            <!-- /…™d/ -->
            <tr class="rule-row" data-target="acc-id" tabindex="0" role="button" aria-expanded="false">
              <td><strong>/…™d/</strong></td>
              <td>Termina en <strong>/t/</strong> o <strong>/d/</strong></td>
              <td>wait ‚Üí wait<strong>ed</strong></td>
              <td>üî¥ S√≠laba EXTRA</td>
            </tr>
            <tr class="rule-accordion" id="acc-id" aria-hidden="true">
              <td colspan="4">
                <div class="rule-accordion-inner">
                  <div class="rule-accordion-content" data-tpl="tpl-rule-id"></div>
                </div>
              </td>
            </tr>

            <!-- /t/ -->
            <tr class="rule-row" data-target="acc-t" tabindex="0" role="button" aria-expanded="false">
              <td><strong>/t/</strong></td>
              <td>Termina en sonido <strong>sordo</strong></td>
              <td>look ‚Üí look<strong>ed</strong></td>
              <td>üü° Sordo + Sordo</td>
            </tr>
            <tr class="rule-accordion" id="acc-t" aria-hidden="true">
              <td colspan="4">
                <div class="rule-accordion-inner">
                  <div class="rule-accordion-content" data-tpl="tpl-rule-t"></div>
                </div>
              </td>
            </tr>

            <!-- /d/ -->
            <tr class="rule-row" data-target="acc-d" tabindex="0" role="button" aria-expanded="false">
              <td><strong>/d/</strong></td>
              <td>Termina en sonido <strong>sonoro</strong> o vocal</td>
              <td>clean ‚Üí clean<strong>ed</strong></td>
              <td>üü¢ Sonoro + Sonoro</td>
            </tr>
            <tr class="rule-accordion" id="acc-d" aria-hidden="true">
              <td colspan="4">
                <div class="rule-accordion-inner">
                  <div class="rule-accordion-content" data-tpl="tpl-rule-d"></div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <!-- Templates de explicaci√≥n completa (NO visibles por defecto) -->
        <template id="tpl-rule-id">
          <h4>üî¥ /…™d/ ‚Üí s√≠laba extra</h4>
          <p><b>Regla:</b> Termina en sonido <b>/t/</b> o <b>/d/</b>, por eso se a√±ade una s√≠laba extra.</p>
          <p><b>Ejemplo:</b> <code>wanted</code> ¬∑ <b>IPA:</b> <code>/Ààw…ín.t…™d/</code> ¬∑ <b>Suena:</b> <span class="sound-chip">WON‚Äìtid</span></p>
          <p style="margin: 10px 0 6px 0;"><b>Sensaci√≥n auditiva:</b></p>
          <ul>
            <li>Dos golpes claros</li>
            <li>Se oye una vocal corta <code>/…™/</code> antes de la <b>d</b></li>
            <li>Parece casi una palabra nueva</li>
          </ul>
          <p><b>Audio ideal dir√≠a:</b> ‚Äúwanted‚Äù ‚Üí <b>won-tid</b></p>
        </template>

        <template id="tpl-rule-t">
          <h4>üü° /t/ ‚Üí sonido sordo</h4>
          <p><b>Regla:</b> Termina en sonido <b>sordo</b> (p, k, f, s, sh, ch, x‚Ä¶), as√≠ que el -ed se pronuncia <b>/t/</b>.</p>
          <p><b>Ejemplo:</b> <code>worked</code> ¬∑ <b>IPA:</b> <code>/w…úÀêkt/</code> ¬∑ <b>Suena:</b> <span class="sound-chip">WORKT</span></p>
          <p style="margin: 10px 0 6px 0;"><b>Sensaci√≥n auditiva:</b></p>
          <ul>
            <li>No hay vocal extra</li>
            <li>Final seco, cortado</li>
            <li>La <b>t</b> se ‚Äúpega‚Äù al verbo</li>
          </ul>
          <p><b>Audio ideal dir√≠a:</b> ‚Äúworked‚Äù ‚Üí <b>workt</b></p>
        </template>

        <template id="tpl-rule-d">
          <h4>üü¢ /d/ ‚Üí sonido sonoro</h4>
          <p><b>Regla:</b> Termina en sonido <b>sonoro</b> (vocal, l, n, r, b, g, v, z, m‚Ä¶), as√≠ que el -ed se pronuncia <b>/d/</b>.</p>
          <p><b>Ejemplo:</b> <code>played</code> ¬∑ <b>IPA:</b> <code>/ple…™d/</code> ¬∑ <b>Suena:</b> <span class="sound-chip">PLEID</span></p>
          <p style="margin: 10px 0 6px 0;"><b>Sensaci√≥n auditiva:</b></p>
          <ul>
            <li>Una sola s√≠laba</li>
            <li>La <b>d</b> final es suave</li>
            <li>La voz sigue vibrando</li>
          </ul>
          <p><b>Audio ideal dir√≠a:</b> ‚Äúplayed‚Äù ‚Üí <b>pleid</b></p>
        </template>
      </div>


<div class="verb-lists-section" id="explorer-verbListsSection">
        <div class="verb-list-container" id="explorer-verbListContainer"></div>
      </div>

      
      <div class="filter-buttons">
            <button class="filter-btn active" data-filter="all" data-scope="adj">Todos</button>
            <button class="filter-btn" data-filter="id" data-scope="adj">üî¥ /…™d/</button>
            <button class="filter-btn" data-filter="t" data-scope="adj">üü° /t/</button>
            <button class="filter-btn" data-filter="d" data-scope="adj">üü¢ /d/</button>
          </div>
        </div>

        
      </div>

      
        </div>

        
      </div>

      <div class="verb-lists-section" id="explorer-adjSection">
        <h2 style="color:#667eea; margin-bottom: 10px;">üß† Adjetivos en -ed (C1)</h2>
        <p style="color:#6c757d; margin-bottom: 20px;">
          30 adjetivos por regla, con buscador y filtros. Pasa el rat√≥n para ver ejemplos.
        </p>

        <div class="controls">
          <div class="search-box">
            <input type="text" id="explorer-adjSearch" placeholder="üîç Buscar adjetivo...">
          </div>
          <div class="filter-buttons">
            <button class="filter-btn active" data-filter="all" data-scope="adj">Todos</button>
            <button class="filter-btn" data-filter="id" data-scope="adj">üî¥ /…™d/</button>
            <button class="filter-btn" data-filter="t" data-scope="adj">üü° /t/</button>
            <button class="filter-btn" data-filter="d" data-scope="adj">üü¢ /d/</button>
          </div>
        </div>

        <div class="verb-list-container" id="explorer-adjContainer"></div>
      </div>


      <div class="practice-mode" id="explorer-practiceMode">
        <div class="quiz-container">
          <h2 style="text-align: center; color: #667eea; margin-bottom: 30px;">üéÆ Modo Pr√°ctica</h2>
          <div class="quiz-question">¬øC√≥mo se pronuncia el -ed en este verbo?</div>
          <div class="quiz-verb" id="explorer-quizVerb">Loading...</div>
          <div class="quiz-options" id="explorer-quizOptions"></div>
          <div class="quiz-score" id="explorer-currentScore">Puntuaci√≥n: 0/0</div>

          <div id="explorer-dragDropChallenge" class="hidden" style="margin-top: 30px; padding: 20px; border: 1px solid #667eea; border-radius: 10px; background: #e7f5ff;">
            <h3 style="color: #667eea; text-align: center; margin-bottom: 20px;">üß© Desaf√≠o: Completa la Frase</h3>

            <div id="explorer-sentenceDisplay" style="font-size: 1.4em; text-align: center; margin-bottom: 25px;"></div>

            <div style="text-align: center;">
              <div id="explorer-dropZone"
                ondragover="explorerAllowDrop(event)"
                ondrop="explorerDrop(event)"
                style="display: inline-block; padding: 15px 30px; border: 3px dashed #667eea; background: white; border-radius: 10px; font-size: 1.2em; min-width: 180px; color: #667eea; font-weight: bold;">
                Arrastra o toca aqu√≠
              </div>
            </div>

            <div id="explorer-dragOptions" style="display: flex; justify-content: center; gap: 20px; margin-top: 30px; flex-wrap: wrap;"></div>

            <div id="explorer-challengeFeedback" style="text-align: center; margin-top: 15px; font-weight: bold;"></div>
          </div>

          <div style="text-align: center; margin-top: 30px;">
            <button class="mode-toggle" id="explorer-nextQuestionBtn" onclick="explorerNextQuestion()">Siguiente ‚û°Ô∏è</button>
            <button class="mode-toggle" style="background: #dc3545; margin-left: 10px;" onclick="explorerTogglePracticeMode()">Volver</button>
          </div>
        </div>
      </div>
    </div>

    <div class="audio-player-float" id="explorer-audioPlayer">
      <div class="audio-player-title" id="explorer-audioTitle">üîä Reproduciendo...</div>
      <audio id="explorer-audioElement" controls style="width: 100%; margin-top: 10px;"></audio>
    </div>
  </section>

  <!-- =========================
       VIEW 2: MISI√ìN
       ========================= -->
  <section class="app-view mission" id="view-mission">

    <div class="content" id="mission-manual-view">
      <h1 style="text-align: center; color: #ffa502;">üìÅ Manual de Agente</h1>

      <div class="rule-card id">
        <h2>1. El sonido /…™d/ üî¥</h2>
        <h3>La S√≠laba Extra</h3>
        <p>Es f√≠sicamente dif√≠cil pasar de un sonido /t/ o /d/ directamente a otra "t" o "d" sin una vocal. Por ello, el idioma a√±ade una s√≠laba adicional.</p>
        <p><b>Regla:</b> Si el verbo termina en <b>T o D</b>.</p>
        <small>Ej: Accepted, Decided, Started...</small>
      </div>

      <div class="rule-card t">
        <h2>2. El sonido /t/ üü°</h2>
        <h3>Regla de Sonidos Sordos</h3>
        <p>Llamado "asimilaci√≥n". Si terminas con un sonido sordo (voiceless), es m√°s natural que el siguiente sea sordo (las cuerdas vocales no vibran).</p>
        <p><b>Regla:</b> Termina en <b>p, k, f, s, sh, ch, x</b>.</p>
        <small>Ej: Asked, Cooked, Watched...</small>
      </div>

      <div class="rule-card d">
        <h2>3. El sonido /d/ üü¢</h2>
        <h3>Regla de Sonidos Sonoros</h3>
        <p>Si el verbo termina en sonido sonoro, tus cuerdas vocales ya est√°n vibrando. Para mantener la fluidez, se usa /d/ (que tambi√©n es sonoro).</p>
        <p><b>Regla:</b> Termina en <b>l, n, r, b, g, v, z, m o Vocal</b>.</p>
        <small>Ej: Allowed, Played, Worried...</small>
      </div>
    </div>

    <div class="content hidden" id="mission-game-view">
      <div class="stats-bar">
        <span>Puntos: <b id="mission-score">0</b></span>
        <span>Racha: <b id="mission-streak">0</b>üî•</span>
      </div>

      <div class="game-header">
        <p>¬øQu√© sonido sigue este verbo?</p>
      </div>

      <div id="mission-verb-box" class="verb-display">READY?</div>

      <div class="btn-grid">
        <button class="choice-btn btn-id" onclick="missionCheckAnswer('id')">
          <span>/…™d/ (S√≠laba Extra)</span> <span>üî¥</span>
        </button>
        <button class="choice-btn btn-t" onclick="missionCheckAnswer('t')">
          <span>/t/ (Sonido Sordo)</span> <span>üü°</span>
        </button>
        <button class="choice-btn btn-d" onclick="missionCheckAnswer('d')">
          <span>/d/ (Sonido Sonoro)</span> <span>üü¢</span>
        </button>
      </div>
    </div>

    <div id="mission-feedback-icon" class="feedback"></div>

    <div class="nav">
      <div class="nav-item active" id="mission-nav-manual" onclick="missionShowView('manual')">
        üìñ<br>Manual
      </div>
      <div class="nav-item" id="mission-nav-game" onclick="missionShowView('game')">
        üéÆ<br>Jugar
      </div>
    </div>
  </section>

  <!-- =========================
       VIEW 3: MIS ERRORES
       ========================= -->
  <section class="app-view errors" id="view-errors">
    <div class="container">
      <div class="header">
        <h1>‚ùå Mis Errores</h1>
        <p>Aprende de tus errores para mejorar tu pronunciaci√≥n</p>
      </div>

      <div class="stats-bar">
        <div class="stat-item">
          <div class="stat-number" id="errors-total">0</div>
          <div class="stat-label">Palabras Diferentes</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="errors-id">0</div>
          <div class="stat-label">En /…™d/</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="errors-t">0</div>
          <div class="stat-label">En /t/</div>
        </div>
        <div class="stat-item">
          <div class="stat-number" id="errors-d">0</div>
          <div class="stat-label">En /d/</div>
        </div>
      </div>

      <div class="content">
        <div id="errors-empty" style="text-align: center; padding: 60px 20px; color: #6c757d;">
          <div style="font-size: 4em; margin-bottom: 20px;">üéØ</div>
          <h2 style="color: #667eea; margin-bottom: 10px;">¬°Sin errores todav√≠a!</h2>
          <p style="font-size: 1.1em;">Juega en la secci√≥n "Misi√≥n" para empezar a practicar.</p>
          <p style="margin-top: 20px;">Los errores que cometas aparecer√°n aqu√≠ para que puedas repasarlos.</p>
        </div>

        <div id="errors-container" style="display: none;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px;">
            <h2 style="margin: 0; color: #2c3e50; font-size: 1.8em;">Palabras para Repasar</h2>
            <button onclick="errorsClearAll()" style="padding: 12px 24px; background: #dc3545; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
              üóëÔ∏è Limpiar
            </button>
          </div>

          <div class="errors-list" id="errors-list"></div>
        </div>
      </div>
    </div>
  </section>

  <script>
    /* =========================
       DATA √öNICO (fusionado)
       - Explorador: verb + example
       - Misi√≥n: usa los mismos verbos (sin perder ninguno)
       ========================= */
        const verbDataFull = {
      id: [
        { verb: 'Accepted', example: 'The team accepted the challenge happily.' },
        { verb: 'Added', example: 'She added some salt to the soup.' },
        { verb: 'Attended', example: 'He attended the workshop yesterday.' },
        { verb: 'Collected', example: 'We collected stamps as children.' },
        { verb: 'Completed', example: 'He completed the marathon in 3 hours.' },
        { verb: 'Counted', example: 'She counted the money carefully.' },
        { verb: 'Decided', example: 'They decided to move to the countryside.' },
        { verb: 'Defended', example: 'The lawyer defended his client successfully.' },
        { verb: 'Depended', example: 'My salary depended on commission.' },
        { verb: 'Doubted', example: 'Nobody doubted his innocence.' },
        { verb: 'Edited', example: 'She edited the final report.' },
        { verb: 'Ended', example: 'The movie ended with a surprise twist.' },
        { verb: 'Expected', example: 'I expected you to be on time.' },
        { verb: 'Hated', example: 'I hated waking up early on Sundays.' },
        { verb: 'Heated', example: 'He heated the milk in the microwave.' },
        { verb: 'Included', example: 'The price included taxes and service.' },
        { verb: 'Invited', example: 'They invited us to dinner.' },
        { verb: 'Invented', example: 'Who invented the light bulb?' },
        { verb: 'Lasted', example: 'The meeting lasted for two long hours.' },
        { verb: 'Limited', example: 'They limited the number of seats.' },
        { verb: 'Located', example: 'The hotel was located downtown.' },
        { verb: 'Needed', example: 'I needed help with my homework.' },
        { verb: 'Noted', example: 'She noted the main points.' },
        { verb: 'Objected', example: 'The defense objected to the question.' },
        { verb: 'Painted', example: 'He painted the wall blue.' },
        { verb: 'Planted', example: 'They planted flowers in the garden.' },
        { verb: 'Printed', example: 'I printed the document this morning.' },
        { verb: 'Protected', example: 'Helmets protected their heads.' },
        { verb: 'Rejected', example: 'They rejected the proposal.' },
        { verb: 'Repeated', example: 'He repeated the question slowly.' },
        { verb: 'Reported', example: 'The journalist reported on the elections.' },
        { verb: 'Requested', example: 'The client requested a full refund.' },
        { verb: 'Rested', example: 'We rested after the hike.' },
        { verb: 'Selected', example: 'She selected the best option.' },
        { verb: 'Separated', example: 'They separated the files by type.' },
        { verb: 'Shouted', example: 'He shouted across the street.' },
        { verb: 'Started', example: 'The race started exactly at noon.' },
        { verb: 'Suggested', example: 'He suggested a different plan.' },
        { verb: 'Supported', example: 'The community supported the new park.' },
        { verb: 'Tasted', example: 'I tasted the spicy curry carefully.' },
        { verb: 'Tested', example: 'They tested the new feature.' },
        { verb: 'Treated', example: 'The doctor treated her cold quickly.' },
        { verb: 'Updated', example: 'She updated the website today.' },
        { verb: 'Visited', example: 'We visited Paris last summer.' },
        { verb: 'Waited', example: 'I waited for the bus.' },
        { verb: 'Wanted', example: 'I wanted to tell you a secret.' },
        { verb: 'Wasted', example: 'He wasted a lot of time.' },
        { verb: 'Audited', example: 'They audited the accounts.' },
        { verb: 'Quoted', example: 'He quoted the author accurately.' },
        { verb: 'Promoted', example: 'She was promoted last month.' },
        { verb: 'Shifted', example: 'The focus shifted quickly.' }
      ],

      t: [
        { verb: 'Asked', example: 'He asked me for directions.' },
        { verb: 'Brushed', example: 'I brushed my teeth before bed.' },
        { verb: 'Clapped', example: 'The audience clapped for the singer.' },
        { verb: 'Cooked', example: 'My mom cooked a delicious meal.' },
        { verb: 'Crashed', example: 'The car crashed into a lamppost.' },
        { verb: 'Crossed', example: 'We crossed the street carefully.' },
        { verb: 'Danced', example: 'They danced all night at the party.' },
        { verb: 'Dropped', example: 'Be careful, you dropped your keys!' },
        { verb: 'Escaped', example: 'The prisoner escaped from jail.' },
        { verb: 'Finished', example: 'I finally finished my project.' },
        { verb: 'Fixed', example: 'The plumber fixed the leaky faucet.' },
        { verb: 'Guessed', example: 'I guessed the correct answer.' },
        { verb: 'Helped', example: 'My neighbor helped me move the furniture.' },
        { verb: 'Hiked', example: 'We hiked up the mountain trail.' },
        { verb: 'Hoped', example: 'I hoped for good weather tomorrow.' },
        { verb: 'Jumped', example: 'The cat jumped onto the shelf.' },
        { verb: 'Kicked', example: 'He kicked the ball out of bounds.' },
        { verb: 'Laughed', example: 'Everyone laughed at the joke.' },
        { verb: 'Looked', example: 'I looked for my glasses everywhere.' },
        { verb: 'Missed', example: 'We missed the bus this morning.' },
        { verb: 'Passed', example: 'I passed the exam easily.' },
        { verb: 'Picked', example: 'He picked up the dropped pen.' },
        { verb: 'Practiced', example: 'They practiced guitar for hours.' },
        { verb: 'Pushed', example: 'I pushed the heavy door open.' },
        { verb: 'Relaxed', example: 'We relaxed on the beach all day.' },
        { verb: 'Skipped', example: 'He skipped the difficult questions.' },
        { verb: 'Stopped', example: 'The car stopped at the red light.' },
        { verb: 'Talked', example: 'We talked about our plans for the trip.' },
        { verb: 'Touched', example: 'She touched the cold glass.' },
        { verb: 'Washed', example: 'He washed the dishes after dinner.' },
        { verb: 'Watched', example: 'We watched a movie last night.' },
        { verb: 'Worked', example: 'I worked ten hours yesterday.' },
        { verb: 'Walked', example: 'She walked home after class.' },
        { verb: 'Packed', example: 'He packed his suitcase quickly.' },
        { verb: 'Locked', example: 'She locked the door at night.' },
        { verb: 'Knocked', example: 'He knocked on the window.' },
        { verb: 'Kissed', example: 'She kissed her child goodnight.' },
        { verb: 'Smoked', example: 'He smoked outside only.' },
        { verb: 'Shopped', example: 'We shopped for groceries on Friday.' },
        { verb: 'Licked', example: 'The dog licked my hand.' },
        { verb: 'Baked', example: 'She baked a chocolate cake.' },
        { verb: 'Chopped', example: 'He chopped the onions finely.' },
        { verb: 'Fished', example: 'They fished by the river.' },
        { verb: 'Matched', example: 'The socks matched perfectly.' },
        { verb: 'Wrapped', example: 'She wrapped the present.' },
        { verb: 'Shipped', example: 'They shipped the package today.' },

        { verb: 'Wished', example: 'I wished you good luck.' },
        { verb: 'Pressed', example: 'She pressed the button.' },
        { verb: 'Slipped', example: 'She slipped on the floor.' }
      ],

      d: [
        { verb: 'Allowed', example: 'The teacher allowed us to leave early.' },
        { verb: 'Answered', example: 'He answered the email promptly.' },
        { verb: 'Arrived', example: 'They arrived early for the meeting.' },
        { verb: 'Belonged', example: 'This coat belonged to my father.' },
        { verb: 'Called', example: 'She called her mom yesterday.' },
        { verb: 'Changed', example: 'The weather changed suddenly.' },
        { verb: 'Cleaned', example: 'We cleaned the house all weekend.' },
        { verb: 'Climbed', example: 'They climbed to the top of the hill.' },
        { verb: 'Closed', example: 'The store closed at 9 PM.' },
        { verb: 'Compared', example: 'I compared the prices of the two phones.' },
        { verb: 'Covered', example: 'Snow covered the entire city.' },
        { verb: 'Damaged', example: 'The storm damaged the roof.' },
        { verb: 'Delayed', example: 'The flight was delayed due to fog.' },
        { verb: 'Enjoyed', example: 'We enjoyed the concert very much.' },
        { verb: 'Explained', example: 'The professor explained the theory.' },
        { verb: 'Filled', example: 'She filled the glass with water.' },
        { verb: 'Filed', example: 'She filed the papers neatly.' },
        { verb: 'Followed', example: 'I followed the recipe exactly.' },
        { verb: 'Happened', example: 'What happened here last night?' },
        { verb: 'Imagined', example: 'I imagined a world without limits.' },
        { verb: 'Joined', example: 'He joined the conversation late.' },
        { verb: 'Hugged', example: 'He hugged his friend goodbye.' },
        { verb: 'Robbed', example: 'They robbed the bank at night.' },
        { verb: 'Listened', example: 'We listened to music on the radio.' },
        { verb: 'Lived', example: 'They lived in London for five years.' },
        { verb: 'Loved', example: 'I loved that movie! It was great.' },
        { verb: 'Managed', example: 'She managed the project successfully.' },
        { verb: 'Measured', example: 'He measured the wood before cutting it.' },
        { verb: 'Moved', example: 'I moved the chair closer to the table.' },
        { verb: 'Named', example: 'They named their daughter Sofia.' },
        { verb: 'Opened', example: 'I opened the window for fresh air.' },
        { verb: 'Planned', example: 'We planned the trip in advance.' },
        { verb: 'Played', example: 'The children played outside yesterday.' },
        { verb: 'Pulled', example: 'He pulled the door hard to open it.' },
        { verb: 'Realized', example: 'I realized my mistake immediately.' },
        { verb: 'Remembered', example: 'She remembered his name instantly.' },
        { verb: 'Saved', example: 'I saved the document before closing.' },
        { verb: 'Signed', example: 'He signed the contract this morning.' },
        { verb: 'Stayed', example: 'We stayed at a hotel downtown.' },
        { verb: 'Traveled', example: 'I traveled to Italy last month.' },
        { verb: 'Towed', example: 'He towed the car to the garage.' },
        { verb: 'Used', example: 'I used my phone to take a picture.' },
        { verb: 'Worried', example: 'I worried about the test results.' },
        { verb: 'Shared', example: 'She shared her lunch with me.' },
        { verb: 'Ordered', example: 'We ordered pizza for dinner last night.' },
        { verb: 'Smiled', example: 'He smiled politely.' },
        { verb: 'Agreed', example: 'They agreed to the plan.' },
        { verb: 'Believed', example: 'She believed his story.' },
        { verb: 'Carried', example: 'She carried the bags upstairs.' },
        { verb: 'Replied', example: 'He replied quickly to my message.' }
      ]
    };

    // Dataset "simple" para la Misi√≥n (igual que tu 2¬™ p√°gina, pero derivado del full)
    const missionVerbData = {
      id: verbDataFull.id.map(x => x.verb),
      t: verbDataFull.t.map(x => x.verb),
      d: verbDataFull.d.map(x => x.verb),
    };

    /* =========================
       APP: CAMBIO DE VISTAS (nuevo)
       ========================= */
    function appShow(which){
      const explorer = document.getElementById('view-explorer');
      const mission = document.getElementById('view-mission');
      const errors = document.getElementById('view-errors');
      
      document.getElementById('tab-explorer').classList.remove('active');
      document.getElementById('tab-mission').classList.remove('active');
      document.getElementById('tab-errors').classList.remove('active');

      explorer.classList.remove('active');
      mission.classList.remove('active');
      errors.classList.remove('active');

      if(which === 'mission'){
        mission.classList.add('active');
        document.getElementById('tab-mission').classList.add('active');
      } else if(which === 'errors'){
        errors.classList.add('active');
        document.getElementById('tab-errors').classList.add('active');
        errorsRender();
      } else {
        explorer.classList.add('active');
        document.getElementById('tab-explorer').classList.add('active');
      }
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    /* =========================
       EXPLORADOR (tu 1¬™ p√°gina, intacta en l√≥gica)
       ========================= */
    let explorerPracticeMode = false;
    let explorerPracticedVerbs = new Set();
    let explorerCurrentFilter = 'all';
    let explorerCurrentQuizVerb = null;
    let explorerQuizCorrect = 0;
    let explorerQuizTotal = 0;

    function explorerGetAudioPaths(verb, category) {
      const folders = ['id_sound/', 't_sound/', 'd_sound/'];
      const folderName = folders[['id', 't', 'd'].indexOf(category)];

      const basePaths = [
        folderName,
        `audio/${folderName}`,
        `audios/${folderName}`,
        `sound/${folderName}`,
        `sounds/${folderName}`,
        `../audio/${folderName}`,
      ];

      const nameVariations = [
        `${verb}..mp3`,
        `${verb}.mp3`,
        `${verb.toLowerCase()}.mp3`,
        `${verb.toLowerCase()}..mp3`,
        `${verb} .mp3`,
        `${verb}_.mp3`,
        `${verb}_ed.mp3`,
      ];

      const allPaths = [];
      for (const base of basePaths) {
        for (const name of nameVariations) {
          allPaths.push(`${base}${name}`);
        }
      }
      return allPaths;
    }

    function explorerInit() {
      explorerRenderVerbLists();
      explorerSetupEventListeners();
      explorerUpdateStats();
    }

    function explorerRenderVerbLists() {
      const container = document.getElementById('explorer-verbListContainer');
      container.innerHTML = '';

      const titles = {
        id: 'üî¥ Verbos /…™d/ - S√≠laba Extra',
        t: 'üü° Verbos /t/ - Sonidos Sordos',
        d: 'üü¢ Verbos /d/ - Sonidos Sonoros'
      };

      Object.keys(verbDataFull).forEach(category => {
        if (explorerCurrentFilter !== 'all' && explorerCurrentFilter !== category) return;

        const verbList = document.createElement('div');
        verbList.className = `verb-list ${category}-list`;
        
        // Crear header del acorde√≥n
        const header = document.createElement('div');
        header.className = 'verb-list-header';
        header.innerHTML = `<h3>${titles[category]}</h3>`;
        
        // Crear contenido colapsable
        const content = document.createElement('div');
        content.className = 'verb-list-content';
        
        const grid = document.createElement('div');
        grid.className = 'verb-grid';
        grid.id = `explorer-grid-${category}`;
        
        content.appendChild(grid);
        verbList.appendChild(header);
        verbList.appendChild(content);
        container.appendChild(verbList);

        // Agregar funcionalidad de acorde√≥n
        header.addEventListener('click', () => {
          verbList.classList.toggle('expanded');
        });

        verbDataFull[category].forEach(item => {
          const verbItem = document.createElement('div');
          verbItem.className = 'verb-item';

          if (explorerPracticedVerbs.has(item.verb)) verbItem.classList.add('played');
          verbItem.textContent = item.verb;

          const exampleSpan = document.createElement('span');
          exampleSpan.className = 'example-text';
          exampleSpan.innerHTML = `<strong>Ejemplo:</strong><br>${item.example}`;
          verbItem.appendChild(exampleSpan);

          verbItem.onclick = () => explorerPlayAudio(item.verb, category);
          grid.appendChild(verbItem);
        });
      });
    }

    async function explorerPlayAudio(verb, category) {
      explorerPracticedVerbs.add(verb);
      explorerUpdateStats();
      explorerRenderVerbLists();

      const audioElement = document.getElementById('explorer-audioElement');
      const audioPlayer = document.getElementById('explorer-audioPlayer');
      const audioTitle = document.getElementById('explorer-audioTitle');

      const paths = explorerGetAudioPaths(verb, category);

      audioTitle.textContent = `üîä ${verb}`;
      audioPlayer.classList.add('show');

      let audioLoaded = false;

      for (const path of paths) {
        try {
          audioElement.src = path;
          await audioElement.play();
          audioLoaded = true;
          break;
        } catch (error) {
          continue;
        }
      }

      if (!audioLoaded) {
        audioTitle.textContent = `‚ùå Audio no encontrado: ${verb}`;
        setTimeout(() => audioPlayer.classList.remove('show'), 2000);
      }

      audioElement.onended = () => {
        setTimeout(() => audioPlayer.classList.remove('show'), 500);
      };
    }

    function explorerSetupEventListeners() {
      document.getElementById('explorer-searchInput').addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        document.querySelectorAll('#explorer-verbListContainer .verb-item').forEach(item => {
          item.style.display = item.textContent.toLowerCase().includes(searchTerm) ? 'block' : 'none';
        });
      });

      document.querySelectorAll('.filter-btn[data-scope="explorer"]').forEach(btn => {
        btn.addEventListener('click', () => {
          document.querySelectorAll('.filter-btn[data-scope="explorer"]').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          explorerCurrentFilter = btn.dataset.filter;
          explorerRenderVerbLists();
        });
      });
    }

    function explorerTogglePracticeMode() {
explorerPracticeMode = !explorerPracticeMode;
      document.getElementById('explorer-rulesSection').classList.toggle('hidden');
      document.getElementById('explorer-verbListsSection').classList.toggle('hidden');
            const adjSection = document.getElementById('explorer-adjSection');
      if (adjSection) adjSection.classList.toggle('hidden');
document.getElementById('explorer-practiceMode').classList.toggle('active');
      document.getElementById('explorer-dragDropChallenge').classList.add('hidden');
      if (explorerPracticeMode) explorerStartQuiz();
    }

    function explorerStartQuiz() {
      document.getElementById('explorer-nextQuestionBtn').classList.remove('hidden');
      explorerNextQuestion();
    }

    function explorerNextQuestion() {
      document.querySelectorAll('#explorer-quizOptions .quiz-option').forEach(opt => {
        opt.classList.remove('correct', 'incorrect');
        opt.onclick = () => explorerCheckAnswer(opt.getAttribute('data-value'), opt);
      });

      document.getElementById('explorer-dragDropChallenge').classList.add('hidden');
      document.getElementById('explorer-quizVerb').style.display = 'block';
      document.getElementById('explorer-quizOptions').style.display = 'grid';
      document.getElementById('explorer-nextQuestionBtn').classList.add('hidden');

      const categories = Object.keys(verbDataFull);
      const randomCategory = categories[Math.floor(Math.random() * categories.length)];
      const verbs = verbDataFull[randomCategory];

      const randomVerbObject = verbs[Math.floor(Math.random() * verbs.length)];

      explorerCurrentQuizVerb = {
        verb: randomVerbObject.verb,
        category: randomCategory,
        example: randomVerbObject.example
      };

      document.getElementById('explorer-quizVerb').textContent = explorerCurrentQuizVerb.verb;

      const optionsContainer = document.getElementById('explorer-quizOptions');
      optionsContainer.innerHTML = '';

      const options = [
        { label: 'üî¥ /…™d/ - S√≠laba extra', value: 'id' },
        { label: 'üü° /t/ - Sonido sordo', value: 't' },
        { label: 'üü¢ /d/ - Sonido sonoro', value: 'd' }
      ];

      options.forEach(option => {
        const optionDiv = document.createElement('div');
        optionDiv.className = 'quiz-option';
        optionDiv.textContent = option.label;
        optionDiv.setAttribute('data-value', option.value);
        optionDiv.onclick = () => explorerCheckAnswer(option.value, optionDiv);
        optionsContainer.appendChild(optionDiv);
      });
    }

    function explorerCheckAnswer(selected, element) {
      explorerQuizTotal++;

      document.querySelectorAll('#explorer-quizOptions .quiz-option').forEach(opt => opt.onclick = null);

      if (selected === explorerCurrentQuizVerb.category) {
        element.classList.add('correct');
        explorerPlayAudio(explorerCurrentQuizVerb.verb, explorerCurrentQuizVerb.category);
        setTimeout(() => explorerStartDragDropChallenge(), 1500);
      } else {
        element.classList.add('incorrect');
        document.querySelectorAll('#explorer-quizOptions .quiz-option').forEach(opt => {
          if (opt.getAttribute('data-value') === explorerCurrentQuizVerb.category) {
            opt.classList.add('correct');
          }
        });
        explorerUpdateQuizScore();
        document.getElementById('explorer-nextQuestionBtn').classList.remove('hidden');
        document.getElementById('explorer-nextQuestionBtn').textContent = "Continuar ‚û°Ô∏è";
      }
    }

    // DRAG & DROP (misma l√≥gica, con ids prefijados)
    function explorerFinalizeAnswer(soundValue, elementId) {
      const dropZone = document.getElementById('explorer-dropZone');
      const challengeFeedback = document.getElementById('explorer-challengeFeedback');
      const element = document.getElementById(elementId);

      if (dropZone.classList.contains('correct') || dropZone.classList.contains('incorrect')) return;

      if (element) element.style.visibility = 'hidden';

      dropZone.textContent = soundValue.toUpperCase();

      if (soundValue === explorerCurrentQuizVerb.category) {
        explorerQuizCorrect++;
        explorerUpdateQuizScore();
        dropZone.classList.add('correct');
        challengeFeedback.textContent = "¬°√âxito! üéâ El sonido coincide con la regla de la frase.";

        dropZone.style.transform = "scale(1.1)";
        setTimeout(() => dropZone.style.transform = "scale(1)", 200);
      } else {
        dropZone.classList.add('incorrect');
        challengeFeedback.textContent = `‚ùå Incorrecto. El sonido correcto era: ${explorerCurrentQuizVerb.category.toUpperCase()}`;
      }

      dropZone.ondrop = null;

      document.getElementById('explorer-nextQuestionBtn').classList.remove('hidden');
      document.getElementById('explorer-nextQuestionBtn').textContent = "Siguiente ‚û°Ô∏è";
    }

    function explorerDrag(ev) {
      ev.dataTransfer.setData("text", ev.target.getAttribute('data-sound'));
      ev.dataTransfer.setData("source-id", ev.target.id);
    }
    function explorerAllowDrop(ev) { ev.preventDefault(); }
    function explorerDrop(ev) {
      ev.preventDefault();
      const draggedSound = ev.dataTransfer.getData("text");
      const draggedElementId = ev.dataTransfer.getData("source-id");
      explorerFinalizeAnswer(draggedSound, draggedElementId);
    }
    function explorerHandleClickOption(ev) {
      const sound = ev.target.getAttribute('data-sound');
      const id = ev.target.id;
      explorerFinalizeAnswer(sound, id);
    }

    function explorerResetDropZone() {
      const dropZone = document.getElementById('explorer-dropZone');
      dropZone.classList.remove('correct', 'incorrect');
      dropZone.textContent = "Arrastra o toca aqu√≠";
      dropZone.ondrop = explorerDrop;
      dropZone.style.transform = "scale(1)";
      document.getElementById('explorer-challengeFeedback').textContent = "";
    }

    function explorerStartDragDropChallenge() {
      document.getElementById('explorer-quizVerb').style.display = 'none';
      document.getElementById('explorer-quizOptions').style.display = 'none';

      const challengeContainer = document.getElementById('explorer-dragDropChallenge');
      challengeContainer.classList.remove('hidden');

      explorerResetDropZone();

      const regex = new RegExp(explorerCurrentQuizVerb.verb, 'i');
      let sentence = explorerCurrentQuizVerb.example.replace(regex, " [ ... ] ");
      document.getElementById('explorer-sentenceDisplay').innerHTML = `Frase: *${sentence}*`;

      const dragOptions = document.getElementById('explorer-dragOptions');
      dragOptions.innerHTML = '';

      const sounds = [
        { label: '/…™d/ (id)', value: 'id' },
        { label: '/t/ (t)', value: 't' },
        { label: '/d/ (d)', value: 'd' }
      ];

      sounds.sort(() => Math.random() - 0.5);

      sounds.forEach((sound, index) => {
        const option = document.createElement('div');
        option.className = 'drag-option';
        option.textContent = sound.label;
        option.id = `explorer-drag-${index}`;

        option.setAttribute('draggable', true);
        option.setAttribute('data-sound', sound.value);
        option.setAttribute('ondragstart', 'explorerDrag(event)');

        option.onclick = explorerHandleClickOption;

        option.style.cursor = 'pointer';
        option.style.visibility = 'visible';

        dragOptions.appendChild(option);
      });
    }

    function explorerUpdateStats() {
      document.getElementById('explorer-totalVerbs').textContent =
        Object.values(verbDataFull).reduce((sum, arr) => sum + arr.length, 0);
      document.getElementById('explorer-practicedVerbs').textContent = explorerPracticedVerbs.size;
      document.getElementById('explorer-quizScore').textContent = `${explorerQuizCorrect}/${explorerQuizTotal}`;
    }

    function explorerUpdateQuizScore() {
      document.getElementById('explorer-currentScore').textContent =
        `Puntuaci√≥n: ${explorerQuizCorrect}/${explorerQuizTotal} (${explorerQuizTotal > 0 ? Math.round(explorerQuizCorrect/explorerQuizTotal*100) : 0}%)`;
      explorerUpdateStats();
    }

    /* =========================
       MISI√ìN (tu 2¬™ p√°gina, intacta en l√≥gica)
       ========================= */
    let missionScore = 0;
    let missionStreak = 0;
    let missionCurrentVerb = "";
    let missionCurrentCat = "";

    function missionShowView(view) {
      document.getElementById('mission-manual-view').classList.add('hidden');
      document.getElementById('mission-game-view').classList.add('hidden');
      document.getElementById('mission-nav-manual').classList.remove('active');
      document.getElementById('mission-nav-game').classList.remove('active');

      if (view === 'manual') {
        document.getElementById('mission-manual-view').classList.remove('hidden');
        document.getElementById('mission-nav-manual').classList.add('active');
      } else {
        document.getElementById('mission-game-view').classList.remove('hidden');
        document.getElementById('mission-nav-game').classList.add('active');
        missionNextVerb();
      }
    }

    function missionNextVerb() {
      const cats = ['id', 't', 'd'];
      missionCurrentCat = cats[Math.floor(Math.random() * 3)];
      const list = missionVerbData[missionCurrentCat];
      missionCurrentVerb = list[Math.floor(Math.random() * list.length)];

      const display = document.getElementById('mission-verb-box');
      display.textContent = missionCurrentVerb.toUpperCase();
      display.style.color = "white";
    }

    function missionCheckAnswer(userChoice) {
      const feedback = document.getElementById('mission-feedback-icon');

      if (userChoice === missionCurrentCat) {
        missionScore += 10 + (missionStreak * 2);
        missionStreak++;
        feedback.textContent = "‚úÖ";
        missionTriggerAnimation();
      } else {
        missionStreak = 0;
        feedback.textContent = "‚ùå";
        missionTriggerAnimation();
        document.getElementById('mission-verb-box').style.color = "#ff4757";
        
        // Guardar el error
        errorsAdd(missionCurrentVerb, missionCurrentCat, userChoice);
      }

      document.getElementById('mission-score').textContent = missionScore;
      document.getElementById('mission-streak').textContent = missionStreak;

      setTimeout(missionNextVerb, 600);
    }

    function missionTriggerAnimation() {
      const f = document.getElementById('mission-feedback-icon');
      f.classList.remove('animate-pop');
      void f.offsetWidth;
      f.classList.add('animate-pop');
    }

    /* =========================
       INIT
       ========================= */
    
    function explorerScrollToRule(targetId){
      const el = document.getElementById(targetId);
      if(!el) return;

      // Ensure we're in Explorer view
      appShow('explorer');

      // Offset for the sticky topbar
      const topbar = document.querySelector('.app-topbar');
      const offset = topbar ? topbar.getBoundingClientRect().height + 12 : 80;

      const y = el.getBoundingClientRect().top + window.pageYOffset - offset;
      window.scrollTo({ top: y, behavior: 'smooth' });

      // Highlight for a moment
      const prev = el.style.boxShadow;
      el.style.boxShadow = '0 0 0 4px rgba(102,126,234,0.25)';
      setTimeout(() => { el.style.boxShadow = prev; }, 900);
    }

    document.addEventListener('click', (e) => {
      const row = e.target.closest('.explorer .rule-row');
      if(row){
        explorerScrollToRule(row.getAttribute('data-target'));
      }
    });

    document.addEventListener('keydown', (e) => {
      const el = document.activeElement;
      if(el && el.classList && el.classList.contains('rule-row') && (e.key === 'Enter' || e.key === ' ')){
        e.preventDefault();
        explorerScrollToRule(el.getAttribute('data-target'));
      }
    });



    function explorerToggleRuleAccordion(row){
      const targetId = row.getAttribute('data-target');
      if(!targetId) return;
      const acc = document.getElementById(targetId);
      if(!acc) return;

      const isOpen = acc.classList.contains('open');

      // close all accordions
      document.querySelectorAll('.explorer .rule-accordion').forEach(r => {
        r.classList.remove('open');
        r.setAttribute('aria-hidden','true');
      });
      document.querySelectorAll('.explorer .rule-row').forEach(r => {
        r.setAttribute('aria-expanded','false');
      });

      // toggle current
      if(!isOpen){
        acc.classList.add('open');
        acc.setAttribute('aria-hidden','false');
        row.setAttribute('aria-expanded','true');
      }
    }

    // Click on rule rows -> accordion
    document.addEventListener('click', (e) => {
      const row = e.target.closest('.explorer .rule-row');
      if(row){
        explorerToggleRuleAccordion(row);
      }
    });

    // Keyboard accessibility
    document.addEventListener('keydown', (e) => {
      const el = document.activeElement;
      if(el && el.classList && el.classList.contains('rule-row') && (e.key === 'Enter' || e.key === ' ')){
        e.preventDefault();
        explorerToggleRuleAccordion(el);
      }
    });

    // Buttons inside accordion -> jump to full explanation section
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('.explorer .rule-jump');
      if(btn){
        e.stopPropagation();
        const jumpId = btn.getAttribute('data-jump');
        const target = document.getElementById(jumpId);
        if(target){
          const topbar = document.querySelector('.app-topbar');
          const offset = topbar ? topbar.getBoundingClientRect().height + 12 : 80;
          const y = target.getBoundingClientRect().top + window.pageYOffset - offset;
          window.scrollTo({ top: y, behavior: 'smooth' });

          const prev = target.style.boxShadow;
          target.style.boxShadow = '0 0 0 4px rgba(102,126,234,0.25)';
          setTimeout(() => { target.style.boxShadow = prev; }, 900);
        }
      }
    });



    // =========================
    // Acorde√≥n de reglas (muestra explicaci√≥n SOLO al pulsar)
    // =========================
    function explorerToggleRuleAccordion(row){
      const targetId = row.getAttribute('data-target');
      if(!targetId) return;
      const acc = document.getElementById(targetId);
      if(!acc) return;

      const isOpen = acc.classList.contains('open');

      // cerrar todo
      document.querySelectorAll('.explorer .rule-accordion').forEach(r=>{
        r.classList.remove('open');
        r.setAttribute('aria-hidden','true');
        const c = r.querySelector('.rule-accordion-content');
        if(c) c.innerHTML = ''; // limpia (no se muestra hasta abrir)
      });
      document.querySelectorAll('.explorer .rule-row').forEach(r=>{
        r.setAttribute('aria-expanded','false');
      });

      // abrir si estaba cerrado
      if(!isOpen){
        acc.classList.add('open');
        acc.setAttribute('aria-hidden','false');
        row.setAttribute('aria-expanded','true');

        // inyectar template (explicaci√≥n completa) debajo
        const c = acc.querySelector('.rule-accordion-content');
        if(c){
          const tplId = c.getAttribute('data-tpl');
          const tpl = document.getElementById(tplId);
          if(tpl){
            c.innerHTML = '';
            c.appendChild(tpl.content.cloneNode(true));
          }
        }
      }
    }

    // listeners
    document.addEventListener('click', (e)=>{
      const row = e.target.closest('.explorer .rule-row');
      if(row){
        explorerToggleRuleAccordion(row);
      }
    });
    document.addEventListener('keydown', (e)=>{
      const el = document.activeElement;
      if(el && el.classList && el.classList.contains('rule-row') && (e.key === 'Enter' || e.key === ' ')){
        e.preventDefault();
        explorerToggleRuleAccordion(el);
      }
    });



    // =========================
    // FIX: Acorde√≥n de reglas (clic en fila) + contenido desde <template>
    // =========================
    function explorerAccordionCloseAll(){
      document.querySelectorAll('.rule-accordion').forEach(r=>{
        r.classList.remove('open');
        r.setAttribute('aria-hidden','true');
        const c = r.querySelector('.rule-accordion-content');
        if(c) c.innerHTML = '';
      });
      document.querySelectorAll('.rule-row').forEach(r=>{
        r.setAttribute('aria-expanded','false');
      });
    }

    function explorerAccordionOpen(row){
      const targetId = row.getAttribute('data-target');
      if(!targetId) return;
      const acc = document.getElementById(targetId);
      if(!acc) return;

      acc.classList.add('open');
      acc.setAttribute('aria-hidden','false');
      row.setAttribute('aria-expanded','true');

      const c = acc.querySelector('.rule-accordion-content');
      if(c){
        const tplId = c.getAttribute('data-tpl');
        const tpl = document.getElementById(tplId);
        if(tpl){
          c.innerHTML = '';
          c.appendChild(tpl.content.cloneNode(true));
        }
      }
    }

    function explorerAccordionToggle(row){
      const targetId = row.getAttribute('data-target');
      const acc = targetId ? document.getElementById(targetId) : null;
      const willOpen = !(acc && acc.classList.contains('open'));
      explorerAccordionCloseAll();
      if(willOpen) explorerAccordionOpen(row);
    }

    // Single delegated listener (works even if you click inside <td>)
    document.addEventListener('click', (e)=>{
      // Only when Explorer view is active
      const explorerView = document.getElementById('view-explorer');
      if(!explorerView || !explorerView.classList.contains('active')) return;

      const row = e.target.closest('.rule-row');
      if(row && row.closest('#explorer-rulesSection')){
        explorerAccordionToggle(row);
      }
    });

    document.addEventListener('keydown', (e)=>{
      const explorerView = document.getElementById('view-explorer');
      if(!explorerView || !explorerView.classList.contains('active')) return;

      const el = document.activeElement;
      if(el && el.classList && el.classList.contains('rule-row') && el.closest('#explorer-rulesSection') && (e.key === 'Enter' || e.key === ' ')){
        e.preventDefault();
        explorerAccordionToggle(el);
      }
    });



    // Force adjective cards to be visible
    document.addEventListener('DOMContentLoaded', ()=>{
      const adj = document.getElementById('explorer-adjSection');
      if(adj) adj.style.display = 'block';
      
      // FORZAR CIERRE DE TODOS LOS ACORDEONES AL CARGAR
      setTimeout(() => {
        const allAccordions = document.querySelectorAll('.explorer .rule-accordion');
        allAccordions.forEach(acc => {
          acc.classList.remove('open');
          acc.style.display = 'none';
        });
        const allRows = document.querySelectorAll('.explorer .rule-row');
        allRows.forEach(row => {
          row.setAttribute('aria-expanded', 'false');
        });
      }, 100);
    });



    // =========================
    // ADJETIVOS -ed (C1) ‚Äî 30 por regla
    // =========================
    const adjectiveData = {
      id: [
        { adj: 'absent-minded', example: 'I can be absent-minded when under pressure.' },
        { adj: 'big-headed', example: 'He grew big-headed after the award.' },
        { adj: 'cold-blooded', example: 'It was a cold-blooded calculation, not a mistake.' },
        { adj: 'complicated', example: 'It was a complicated ethical dilemma.' },
        { adj: 'crowded', example: 'The platform was dangerously crowded.' },
        { adj: 'dedicated', example: 'She is dedicated to evidence-based practice.' },
        { adj: 'disconnected', example: 'A disconnected narrative weakens credibility.' },
        { adj: 'gifted', example: 'He is gifted at strategic thinking.' },
        { adj: 'guarded', example: 'She offered a guarded response to the allegation.' },
        { adj: 'hard-headed', example: 'He is hard-headed, but not unreasonable.' },
        { adj: 'heavy-handed', example: 'A heavy-handed approach can backfire.' },
        { adj: 'integrated', example: 'An integrated framework reduces blind spots.' },
        { adj: 'kind-hearted', example: 'She is kind-hearted yet uncompromising on standards.' },
        { adj: 'learned', example: 'A learned analysis can still be contested.' },
        { adj: 'level-headed', example: 'A level-headed response defused the tension.' },
        { adj: 'long-winded', example: 'His long-winded answer was oddly persuasive.' },
        { adj: 'motivated', example: 'A motivated learner thrives on constructive feedback.' },
        { adj: 'open-ended', example: 'We asked open-ended questions to elicit detail.' },
        { adj: 'open-minded', example: 'Try to remain open-minded in contentious debates.' },
        { adj: 'overrated', example: 'The film is widely overrated, in my view.' },
        { adj: 'short-sighted', example: 'That policy was painfully short-sighted.' },
        { adj: 'single-minded', example: 'She is single-minded about excellence.' },
        { adj: 'sophisticated', example: 'A sophisticated argument demands nuance.' },
        { adj: 'talented', example: 'She is a remarkably talented negotiator.' },
        { adj: 'targeted', example: 'They introduced targeted interventions to curb misuse.' },
        { adj: 'thick-headed', example: 'Don‚Äôt be thick-headed about feedback.' },
        { adj: 'underrated', example: 'Her contribution is seriously underrated.' },
        { adj: 'unwanted', example: 'The unwanted attention became intrusive.' },
        { adj: 'wounded', example: 'He gave a wounded reply, but stayed composed.' }
      ],
      t: [
        { adj: 'accomplished', example: 'An accomplished scholar, she publishes widely.' },
        { adj: 'advanced', example: 'It‚Äôs an advanced course in rhetoric.' },
        { adj: 'bewitched', example: 'He seemed bewitched by the spectacle.' },
        { adj: 'biased', example: 'The coverage felt biased and incomplete.' },
        { adj: 'boxed', example: 'Boxed solutions rarely scale well.' },
        { adj: 'convinced', example: 'I‚Äôm not convinced by that evidence.' },
        { adj: 'detached', example: 'She sounded detached from the consequences.' },
        { adj: 'distressed', example: 'He sounded distressed on the phone.' },
        { adj: 'enhanced', example: 'The platform offers enhanced security.' },
        { adj: 'etched', example: 'The experience is etched into my memory.' },
        { adj: 'fixed', example: 'A fixed mindset limits growth.' },
        { adj: 'half-baked', example: 'That‚Äôs a half-baked idea at best.' },
        { adj: 'handpicked', example: 'A handpicked team handled the crisis.' },
        { adj: 'increased', example: 'We observed increased volatility in the market.' },
        { adj: 'misplaced', example: 'That is misplaced confidence.' },
        { adj: 'mixed', example: 'I have mixed feelings about the proposal.' },
        { adj: 'overcooked', example: 'The steak was overcooked and chewy.' },
        { adj: 'overlooked', example: 'An overlooked detail can be decisive.' },
        { adj: 'parched', example: 'My throat felt parched after the speech.' },
        { adj: 'perplexed', example: 'I was perplexed by the inconsistency.' },
        { adj: 'polished', example: 'He delivered a polished presentation.' },
        { adj: 'reduced', example: 'They proposed reduced emissions targets.' },
        { adj: 'scorched', example: 'The fields were scorched after the heatwave.' },
        { adj: 'stressed', example: 'I feel stressed before high-stakes exams.' },
        { adj: 'stretched', example: 'A stretched budget forces trade-offs.' },
        { adj: 'tight-lipped', example: 'They remained tight-lipped about the inquiry.' },
        { adj: 'time-pressed', example: 'I‚Äôm time-pressed this week, unfortunately.' },
        { adj: 'undercooked', example: 'The rice was undercooked and gritty.' },
        { adj: 'underdeveloped', example: 'It‚Äôs an underdeveloped proposal that needs work.' }
      ],
      d: [

        { adj: 'authorized', example: 'Only authorized personnel may access the records.' },
        { adj: 'bargained', example: 'It was a bargained settlement, not a concession.' },
        { adj: 'battered', example: 'A battered reputation is hard to rebuild.' },
        { adj: 'broad-minded', example: 'A broad-minded approach helps in negotiations.' },
        { adj: 'customized', example: 'A customized approach may yield better outcomes.' },
        { adj: 'embedded', example: 'An embedded assumption can skew analysis.' },
        { adj: 'hard-won', example: 'It was a hard-won victory.' },
        { adj: 'ill-advised', example: 'It was an ill-advised remark.' },
        { adj: 'insured', example: 'The property is fully insured.' },
        { adj: 'misguided', example: 'That is a misguided conclusion.' },
        { adj: 'open-hearted', example: 'An open-hearted apology helped.' },
        { adj: 'privileged', example: 'It‚Äôs a privileged perspective, not a universal one.' },
        { adj: 'qualified', example: 'A qualified candidate will stand out.' },
        { adj: 'required', example: 'This is a required reading list.' },
        { adj: 'renowned', example: 'A renowned expert chaired the panel.' },
        { adj: 'seasoned', example: 'A seasoned diplomat reads the room.' },
        { adj: 'self-centered', example: 'Self-centered leadership erodes trust.' },
        { adj: 'soft-spoken', example: 'He is soft-spoken but firm.' },
        { adj: 'strategized', example: 'They adopted a strategized communication plan.' },
        { adj: 'thin-skinned', example: 'He is thin-skinned about criticism.' },
        { adj: 'two-pronged', example: 'They proposed a two-pronged strategy.' },
        { adj: 'two-sided', example: 'It‚Äôs a two-sided argument.' },
        { adj: 'unbiased', example: 'We need an unbiased assessment.' },
        { adj: 'warm-hearted', example: 'A warm-hearted welcome eased tensions.' },
        { adj: 'well-informed', example: 'A well-informed opinion matters.' },
        { adj: 'well-read', example: 'She is well-read and articulate.' },
        { adj: 'well-reasoned', example: 'It was a well-reasoned critique.' },
        { adj: 'world-weary', example: 'He sounded world-weary, not cynical.' }
      ]
    };

    let explorerAdjFilter = 'all';

    function explorerRenderAdjectives(){
      const container = document.getElementById('explorer-adjContainer');
      if(!container) return;
      container.innerHTML = '';

      const titles = {
        id: 'üî¥ Adjetivos /…™d/',
        t: 'üü° Adjetivos /t/',
        d: 'üü¢ Adjetivos /d/'
      };

      ['id','t','d'].forEach(cat => {
        if(explorerAdjFilter !== 'all' && explorerAdjFilter !== cat) return;

        const list = document.createElement('div');
        list.className = `verb-list ${cat}-list`;
        
        // Crear header del acorde√≥n
        const header = document.createElement('div');
        header.className = 'verb-list-header';
        header.innerHTML = `<h3>${titles[cat]}</h3>`;
        
        // Crear contenido colapsable
        const content = document.createElement('div');
        content.className = 'verb-list-content';
        
        const grid = document.createElement('div');
        grid.className = 'verb-grid';
        grid.id = `explorer-adj-grid-${cat}`;
        
        content.appendChild(grid);
        list.appendChild(header);
        list.appendChild(content);
        container.appendChild(list);

        // Agregar funcionalidad de acorde√≥n
        header.addEventListener('click', () => {
          list.classList.toggle('expanded');
        });

        adjectiveData[cat].forEach(item => {
          const card = document.createElement('div');
          card.className = 'verb-item';
          card.textContent = (item.adj || item.word || '');

          const exampleSpan = document.createElement('span');
          exampleSpan.className = 'example-text';
          exampleSpan.innerHTML = `<strong>Ejemplo:</strong><br>${item.example}`;
          card.appendChild(exampleSpan);

          grid.appendChild(card);
        });
      });

      const q = (document.getElementById('explorer-adjSearch')?.value || '').toLowerCase();
      if(q){
        document.querySelectorAll('#explorer-adjContainer .verb-item').forEach(item=>{
          item.style.display = item.textContent.toLowerCase().includes(q) ? 'block' : 'none';
        });
      }
    }

    function explorerInitAdjectives(){
      const section = document.getElementById('explorer-adjSection');
      if(!section) return;

      const search = document.getElementById('explorer-adjSearch');
      if(search){
        search.addEventListener('input', (e)=>{
          const q = e.target.value.toLowerCase();
          document.querySelectorAll('#explorer-adjContainer .verb-item').forEach(item=>{
            item.style.display = item.textContent.toLowerCase().includes(q) ? 'block' : 'none';
          });
        });
      }

      document.querySelectorAll('.filter-btn[data-scope="adj"]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          document.querySelectorAll('.filter-btn[data-scope="adj"]').forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          explorerAdjFilter = btn.dataset.filter;
          explorerRenderAdjectives();
        });
      });

      explorerRenderAdjectives();
    }


window.onload = () => {
      explorerInit();
      explorerInitAdjectives();
      // safeguard adjetivos

      setTimeout(() => {
        const c = document.getElementById('explorer-adjContainer');
        if(c && c.children.length === 0 && typeof explorerRenderAdjectives === 'function'){
          explorerRenderAdjectives();
        }
      }, 100);
// misi√≥n no inicia el juego hasta que cambies a "Jugar", igual que tu original
    };


    /* =========================
       GESTI√ìN DE ERRORES
       ========================= */
    let errorsData = JSON.parse(localStorage.getItem('pronun_errors') || '{}');

    function errorsAdd(verb, correctAnswer, wrongAnswer) {
      if (!errorsData[verb]) {
        errorsData[verb] = {
          verb: verb,
          correctAnswer: correctAnswer,
          wrongAnswers: {},
          count: 0,
          lastError: new Date().toISOString()
        };
      }
      
      if (!errorsData[verb].wrongAnswers[wrongAnswer]) {
        errorsData[verb].wrongAnswers[wrongAnswer] = 0;
      }
      
      errorsData[verb].wrongAnswers[wrongAnswer]++;
      errorsData[verb].count++;
      errorsData[verb].lastError = new Date().toISOString();
      
      errorsSave();
    }

    function errorsSave() {
      localStorage.setItem('pronun_errors', JSON.stringify(errorsData));
    }

    function errorsRender() {
      const container = document.getElementById('errors-list');
      const emptyState = document.getElementById('errors-empty');
      const errorsContainer = document.getElementById('errors-container');
      
      const errorsList = Object.values(errorsData);
      
      if (errorsList.length === 0) {
        emptyState.style.display = 'block';
        errorsContainer.style.display = 'none';
        errorsUpdateStats();
        return;
      }
      
      emptyState.style.display = 'none';
      errorsContainer.style.display = 'block';
      
      // Ordenar alfab√©ticamente
      errorsList.sort((a, b) => a.verb.localeCompare(b.verb));
      
      container.innerHTML = '';
      
      const labels = {
        id: '/…™d/ - S√≠laba Extra',
        t: '/t/ - Sonido Sordo',
        d: '/d/ - Sonido Sonoro'
      };
      
      const colors = {
        id: 'id-error',
        t: 't-error',
        d: 'd-error'
      };
      
      errorsList.forEach(error => {
        const card = document.createElement('div');
        card.className = `error-card ${colors[error.correctAnswer]}`;
        
        card.innerHTML = `
          <div class="error-card-word">${error.verb}</div>
          <div class="error-card-answer">${labels[error.correctAnswer]}</div>
        `;
        
        container.appendChild(card);
      });
      
      errorsUpdateStats();
    }

    function errorsUpdateStats() {
      const errorsList = Object.values(errorsData);
      const total = errorsList.length; // Contar palabras √∫nicas
      
      const byCategory = {
        id: 0,
        t: 0,
        d: 0
      };
      
      errorsList.forEach(err => {
        byCategory[err.correctAnswer] = (byCategory[err.correctAnswer] || 0) + 1; // +1 por palabra √∫nica
      });
      
      document.getElementById('errors-total').textContent = total;
      document.getElementById('errors-id').textContent = byCategory.id;
      document.getElementById('errors-t').textContent = byCategory.t;
      document.getElementById('errors-d').textContent = byCategory.d;
    }

    function errorsClearAll() {
      if (confirm('¬øEst√°s seguro de que quieres borrar todos tus errores? Esta acci√≥n no se puede deshacer.')) {
        errorsData = {};
        errorsSave();
        errorsRender();
      }
    }

    // Renderizar errores al cargar la p√°gina
    document.addEventListener('DOMContentLoaded', () => {
      errorsUpdateStats();
    });

  </script>
</body>
</html>
